{"version":3,"file":"profile-76529290.js","sources":["../../../../assets/images/clipboard.svg","../../../../assets/images/user-image.svg","../../../../pages/profile.vue"],"sourcesContent":["export default \"__VITE_ASSET__81a9f0ca__\"","export default \"__VITE_ASSET__c4b796e2__\"","<script setup>\r\nimport UserImage from \"@/assets/images/user-image.svg\";\r\nimport {\r\n  apiGetProfileUrl,\r\n  apiUploadFilesUrl,\r\n  apiUpdateProfileUrl,\r\n  apiChangePasswordUrl,\r\n} from \"@/server\";\r\n\r\nconst { fire } = useApi({\r\n  url: apiGetProfileUrl,\r\n});\r\n\r\nconst { pending, data: profileData } = await fire();\r\n\r\nconsole.log(profileData.value);\r\n\r\nconst { user } = useAuth();\r\n\r\nconst copied = ref(false);\r\n\r\nconst copyRef = ref();\r\n\r\nfunction copyToClipoard() {\r\n  var range = document.createRange();\r\n  range.selectNode(copyRef.value);\r\n  window.getSelection().removeAllRanges();\r\n  window.getSelection().addRange(range);\r\n  document.execCommand(\"copy\");\r\n  window.getSelection().removeAllRanges();\r\n  copied.value = true;\r\n  const copiedTimeOut = setTimeout(() => {\r\n    copied.value = false;\r\n    clearTimeout(copiedTimeOut);\r\n  }, 600);\r\n}\r\n\r\nconst isUploading = ref(false);\r\n\r\nconst newAvatar = ref(null);\r\n\r\nconst form = reactive({\r\n  avatar: profileData.value.data.avatar,\r\n  name: profileData.value.data.name,\r\n  phone: profileData.value.data.phone,\r\n  email: profileData.value.data.email,\r\n});\r\n\r\nasync function uploadImage(e) {\r\n  const files = e.target.files;\r\n  if (files.length) {\r\n    isUploading.value = true;\r\n    const fd = new FormData();\r\n    fd.append(\"image\", files[0]);\r\n    const { fire: uploadFire } = useApi({\r\n      url: apiUploadFilesUrl,\r\n      requestOptions: {\r\n        method: \"post\",\r\n        body: fd,\r\n        onResponse: (response) => {\r\n          if (response.response.ok) {\r\n            form.avatar = response.response._data.url;\r\n            newAvatar.value = window.URL.createObjectURL(files[0]);\r\n          }\r\n        },\r\n      },\r\n    });\r\n\r\n    await uploadFire(fd);\r\n\r\n    isUploading.value = false;\r\n  }\r\n}\r\n\r\nconst passwordForm = reactive({\r\n  old_password: \"\",\r\n  new_password: \"\",\r\n  confirm_new_password: \"\",\r\n});\r\n\r\nconst { fire: updateInfoFire } = useApi({\r\n  url: apiUpdateProfileUrl,\r\n  requestOptions: {\r\n    method: \"post\",\r\n  },\r\n});\r\n\r\nconst isUpdateInfo = ref(false);\r\n\r\nasync function submitInfo() {\r\n  isUpdateInfo.value = true;\r\n  await updateInfoFire(form);\r\n  isUpdateInfo.value = false;\r\n}\r\n\r\nconst { fire: updatePasswordFire } = useApi({\r\n  url: apiChangePasswordUrl,\r\n  requestOptions: {\r\n    method: \"patch\",\r\n  },\r\n});\r\n\r\nconst isUpdatePassword = ref(false);\r\n\r\nasync function submitPassword() {\r\n  isUpdatePassword.value = true;\r\n  await updatePasswordFire(passwordForm);\r\n  isUpdatePassword.value = false;\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"bg-primary\">\r\n    <shared-title title=\"اعدادات الحساب\" />\r\n\r\n    <div class=\"flex gap-24\">\r\n      <!-- photo  -->\r\n      <div class=\"w-[22.5rem] flex flex-col gap-9\">\r\n        <div\r\n          class=\"w-full h-[22.5rem] border border-gray-200 bg-gray-100 rounded-3xl flex justify-center items-end\"\r\n        >\r\n          <img\r\n            :src=\"newAvatar || profileData.data.avatar || UserImage\"\r\n            :alt=\"profileData.data.name\"\r\n            class=\"\"\r\n          />\r\n        </div>\r\n\r\n        <input\r\n          type=\"file\"\r\n          id=\"upload-avatar\"\r\n          class=\"hidden\"\r\n          @change=\"uploadImage\"\r\n        />\r\n        <label\r\n          class=\"cursor-pointer flex items-center justify-center gap-[1.19rem] leading-normal text-gray-700 text-2xl w-full h-[3.5625rem] border border-gray-200 bg-white rounded-[.75rem]\"\r\n          for=\"upload-avatar\"\r\n        >\r\n          <div class=\"loading-container\" v-if=\"isUploading\">\r\n            <shared-loders-loader-button />\r\n          </div>\r\n          <img\r\n            v-else\r\n            src=\"@/assets/images/upload-icon.svg\"\r\n            alt=\"upload avatar\"\r\n            class=\"\"\r\n          />\r\n          <span>تحميل صورة جديدة</span>\r\n        </label>\r\n\r\n        <div\r\n          class=\"flex items-center gap-4 text-2xl text-gray-500 leading-normal\"\r\n        >\r\n          <span>كود التاجر:</span>\r\n          <span ref=\"copyRef\">{{ profileData.data.id }}</span>\r\n          <img\r\n            v-if=\"!copied\"\r\n            @click=\"copyToClipoard\"\r\n            src=\"@/assets/images/clipboard.svg\"\r\n            alt=\"clipboard\"\r\n            class=\"cursor-pointer\"\r\n          />\r\n          <Icon v-else name=\"la:check-circle\" class=\"text-primary-300\" />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"flex-1 max-w-[38rem]\">\r\n        <form class=\"mb-24\" @submit.prevent=\"submitInfo\">\r\n          <h5 class=\"text-2xl text-gray-700 mb-16\">المعلومات الشخصية</h5>\r\n          <div class=\"mb-6\">\r\n            <label for=\"firstName\" class=\"text-2xl text-gray-500 mb-6 block\"\r\n              >الاسم:</label\r\n            >\r\n            <shared-form-input\r\n              placeholder=\"الاسم الأول\"\r\n              class=\"bg-transparent !w-full\"\r\n              id=\"firstName\"\r\n              type=\"text\"\r\n              v-model=\"form.name\"\r\n            />\r\n          </div>\r\n\r\n          <div class=\"flex-1 mb-6\">\r\n            <label for=\"phoneNumber\" class=\"text-2xl text-gray-500 mb-6 block\"\r\n              >رقم الهاتف:</label\r\n            >\r\n            <shared-form-input\r\n              placeholder=\"رقم الهاتف\"\r\n              class=\"bg-transparent !w-full\"\r\n              id=\"phoneNumber\"\r\n              type=\"text\"\r\n              v-model=\"form.phone\"\r\n            />\r\n          </div>\r\n\r\n          <div class=\"flex-1 mb-24\">\r\n            <label for=\"email\" class=\"text-2xl text-gray-500 mb-6 block\"\r\n              >البريد الإلكتروني:</label\r\n            >\r\n            <shared-form-input\r\n              placeholder=\"البريد الإلكتروني\"\r\n              class=\"bg-transparent !w-full\"\r\n              id=\"email\"\r\n              type=\"email\"\r\n              v-model=\"form.email\"\r\n            />\r\n          </div>\r\n\r\n          <shared-buttons-secondary-button\r\n            submit-title=\"حفظ التغييرات\"\r\n            type=\"submit\"\r\n            class=\"!text-[1.875rem] !px-[3.5rem] w-auto h-auto py-[1.25rem]\"\r\n            :loading=\"isUpdateInfo\"\r\n          />\r\n        </form>\r\n        <form @submit.prevent=\"submitPassword\">\r\n          <h5 class=\"text-2xl text-gray-700 mb-16\">تغيير كلمة المرور</h5>\r\n\r\n          <div class=\"flex-1 mb-16\">\r\n            <shared-form-input\r\n              placeholder=\"كلمة المرور الحالية\"\r\n              class=\"bg-transparent !w-full\"\r\n              id=\"currentPassword\"\r\n              type=\"password\"\r\n              v-model=\"passwordForm.old_password\"\r\n            />\r\n          </div>\r\n\r\n          <div class=\"flex-1 mb-6\">\r\n            <shared-form-input\r\n              placeholder=\"كلمة المرور الجديدة\"\r\n              class=\"bg-transparent !w-full\"\r\n              id=\"newPassword\"\r\n              type=\"password\"\r\n              v-model=\"passwordForm.new_password\"\r\n            />\r\n          </div>\r\n\r\n          <div class=\"flex-1 mb-24\">\r\n            <shared-form-input\r\n              placeholder=\"تأكيد كلمة المرور الجديدة\"\r\n              class=\"bg-transparent !w-full\"\r\n              id=\"confirmNewPassword\"\r\n              type=\"password\"\r\n              v-model=\"passwordForm.confirm_new_password\"\r\n            />\r\n          </div>\r\n\r\n          <shared-buttons-secondary-button\r\n            submit-title=\"حفظ التغييرات\"\r\n            type=\"submit\"\r\n            class=\"!text-[1.875rem] !px-[3.5rem] w-auto h-auto py-[1.25rem]\"\r\n            :loading=\"isUpdatePassword\"\r\n          />\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n.loading-container .lds-ellipsis div {\r\n  background-color: theme(\"colors.primary.300\");\r\n}\r\n</style>\r\n"],"names":["_withAsyncContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAe,aAAA,KAAA,iBAAA,wBAAA;ACAf,MAAe,YAAA,KAAA,iBAAA,yBAAA;;;;;;;ACSf,UAAM,EAAE,KAAM,IAAG,OAAO;AAAA,MACtB,KAAK;AAAA,IACP,CAAC;AAED,UAAM,EAAE,SAAS,MAAM,YAAa,KAAG,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,KAAI,CAAC;AAElD,YAAQ,IAAI,YAAY,KAAK;AAEZ,YAAU;AAE3B,UAAM,SAAS,IAAI,KAAK;AAER,QAAM;AAgBtB,UAAM,cAAc,IAAI,KAAK;AAE7B,UAAM,YAAY,IAAI,IAAI;AAE1B,UAAM,OAAO,SAAS;AAAA,MACpB,QAAQ,YAAY,MAAM,KAAK;AAAA,MAC/B,MAAM,YAAY,MAAM,KAAK;AAAA,MAC7B,OAAO,YAAY,MAAM,KAAK;AAAA,MAC9B,OAAO,YAAY,MAAM,KAAK;AAAA,IAChC,CAAC;AA4BD,UAAM,eAAe,SAAS;AAAA,MAC5B,cAAc;AAAA,MACd,cAAc;AAAA,MACd,sBAAsB;AAAA,IACxB,CAAC;AASD,UAAM,eAAe,IAAI,KAAK;AAe9B,UAAM,mBAAmB,IAAI,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}