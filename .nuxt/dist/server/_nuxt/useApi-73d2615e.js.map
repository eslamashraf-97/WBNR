{"version":3,"file":"useApi-73d2615e.js","sources":["../../../../composables/useApi.js"],"sourcesContent":["import { toast } from \"vue3-toastify\";\r\n\r\nexport default function ({ url, requestOptions = {} }) {\r\n  const isServer = typeof window === \"undefined\";\r\n\r\n  async function fire(data) {\r\n    const requestArgs = await useFetch(url, {\r\n      // request\r\n      onRequest({ request, options }) {\r\n        // get cookies\r\n        const cookies = useCookie(\"token\");\r\n\r\n        // headers\r\n        options.headers = options.headers || {};\r\n        options.headers[\"Authorization\"] = `Bearer ${cookies.value}`;\r\n        options.headers[\"Accept-Language\"] = \"ar\";\r\n        options.headers[\"Content-Language\"] = \"ar\";\r\n        options.headers[\"Accept\"] = \"application/json\";\r\n        options.headers[\"ContentType\"] = \"application/json\";\r\n      },\r\n\r\n      onRequestError({ request, options, error }) {\r\n        console.log(\"request error\", error);\r\n      },\r\n\r\n      onResponse({ request, response, options }) {\r\n        if (response.ok) {\r\n          const responseData = response._data;\r\n          if (responseData && !isServer && options.method !== \"GET\") {\r\n            if (responseData?.message) {\r\n              toast.success(responseData?.message);\r\n            }\r\n          }\r\n        }\r\n      },\r\n\r\n      onResponseError({ response }) {\r\n        const responseData = response._data;\r\n\r\n        if (responseData && !isServer) {\r\n          if (responseData?.message) {\r\n            toast.error(responseData?.message);\r\n          }\r\n          if (error.response?.status === 401) {\r\n            // localStorage.removeItem(\"token\");\r\n            // window.location.pathname = \"/auth/login\";\r\n          }\r\n        }\r\n\r\n        // if (isServer && error.response) {\r\n        //   if (error.response?.status === 401) {\r\n        //     cookies.value = null;\r\n        //   }\r\n        // }\r\n      },\r\n\r\n      baseURL: \"http://85.31.238.244:3000/v1\",\r\n      method: \"get\",\r\n      body: JSON.stringify(data),\r\n      ...requestOptions,\r\n    });\r\n    return { ...requestArgs };\r\n  }\r\n\r\n  return { fire };\r\n}\r\n"],"names":["error"],"mappings":";;;;;;;;;AAEe,SAAQ,OAAE,EAAE,KAAK,iBAAiB,CAAA,KAAM;AACrD,QAAM,WAAW;AAEjB,iBAAe,KAAK,MAAM;AACxB,UAAM,cAAc,MAAM,SAAS,KAAK;AAAA;AAAA,MAEtC,UAAU,EAAE,SAAS,WAAW;AAE9B,cAAM,UAAU,UAAU,OAAO;AAGjC,gBAAQ,UAAU,QAAQ,WAAW,CAAA;AACrC,gBAAQ,QAAQ,eAAe,IAAI,UAAU,QAAQ,KAAK;AAC1D,gBAAQ,QAAQ,iBAAiB,IAAI;AACrC,gBAAQ,QAAQ,kBAAkB,IAAI;AACtC,gBAAQ,QAAQ,QAAQ,IAAI;AAC5B,gBAAQ,QAAQ,aAAa,IAAI;AAAA,MAClC;AAAA,MAED,eAAe,EAAE,SAAS,SAAS,OAAAA,OAAK,GAAI;AAC1C,gBAAQ,IAAI,iBAAiBA,MAAK;AAAA,MACnC;AAAA,MAED,WAAW,EAAE,SAAS,UAAU,QAAO,GAAI;AACzC,YAAI,SAAS,IAAI;AACf,gBAAM,eAAe,SAAS;AAC9B,cAAI,gBAAgB,CAAC,YAAY,QAAQ,WAAW,OAAO;AACzD,gBAAI,6CAAc,SAAS;AACzB,oBAAM,QAAQ,6CAAc,OAAO;AAAA,YACpC;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,MAED,gBAAgB,EAAE,YAAY;;AAC5B,cAAM,eAAe,SAAS;AAE9B,YAAI,gBAAgB,CAAC,UAAU;AAC7B,cAAI,6CAAc,SAAS;AACzB,kBAAM,MAAM,6CAAc,OAAO;AAAA,UAClC;AACD,gBAAI,WAAM,aAAN,mBAAgB,YAAW;AAAK;AAAA,QAIrC;AAAA,MAOF;AAAA,MAED,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,MAAM,KAAK,UAAU,IAAI;AAAA,MACzB,GAAG;AAAA,IACJ,GAAA,aAAA;AACD,WAAO,EAAE,GAAG;EACb;AAED,SAAO,EAAE,KAAI;AACf;"}