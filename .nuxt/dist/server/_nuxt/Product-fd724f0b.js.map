{"version":3,"file":"Product-fd724f0b.js","sources":["../../../../components/shared/cards/Product.vue"],"sourcesContent":["<script setup>\r\nimport {\r\n  apiSaveProductUrl,\r\n  apiRemoveProductUrl,\r\n  apiAddToCartUrl,\r\n} from \"@/server\";\r\n\r\nimport { productStatus } from \"@/constants\";\r\n\r\nconst { setSavedProductsCount, savedProductsCount } = useSavedProducts();\r\n\r\nconst { cartLength, setCartLength } = useCartLength();\r\n\r\nconst props = defineProps({\r\n  details: {\r\n    type: Object,\r\n  },\r\n});\r\n\r\n// favourit products options\r\n\r\nconst saveProductIsLoading = ref(false);\r\n\r\nconst savedProduct = ref(props.details.is_favorite);\r\n\r\n// add product to favourit\r\nconst { fire: saveProductFire } = useApi({\r\n  url: () => apiSaveProductUrl + \"/\" + props.details.id,\r\n  requestOptions: {\r\n    method: \"POST\",\r\n  },\r\n});\r\n\r\nasync function saveProduct() {\r\n  saveProductIsLoading.value = true;\r\n  const { status } = await saveProductFire();\r\n  console.log(status);\r\n  if (status.value === \"success\") {\r\n    savedProduct.value = true;\r\n    setSavedProductsCount(savedProductsCount.value + 1);\r\n  }\r\n  saveProductIsLoading.value = false;\r\n}\r\n\r\n// remove product from favourite\r\nconst { fire: removeProductFire } = useApi({\r\n  url: () => apiRemoveProductUrl + \"/\" + props.details.id,\r\n  requestOptions: {\r\n    method: \"DELETE\",\r\n  },\r\n});\r\n\r\nasync function removeProduct() {\r\n  saveProductIsLoading.value = true;\r\n  const { status } = await removeProductFire();\r\n  console.log(status.value);\r\n  if (status.value === \"success\") {\r\n    savedProduct.value = false;\r\n    setSavedProductsCount(savedProductsCount.value - 1);\r\n  }\r\n  saveProductIsLoading.value = false;\r\n}\r\n\r\n// cart products options\r\nconst addProductToCartIsLoading = ref(false);\r\n\r\n// add product to favourit\r\nconst { fire: addProductToCartFire } = useApi({\r\n  url: () => apiAddToCartUrl,\r\n  requestOptions: {\r\n    method: \"POST\",\r\n  },\r\n});\r\n\r\nasync function addProductToCart() {\r\n  addProductToCartIsLoading.value = true;\r\n  const { status } = await addProductToCartFire({\r\n    product_id: props.details.id,\r\n    quantity: 1,\r\n    final_price: props.details.price,\r\n  });\r\n  if (status.value === \"success\") {\r\n    setCartLength(cartLength + 1);\r\n  }\r\n  addProductToCartIsLoading.value = false;\r\n}\r\n\r\nconst productStatuses = computed(() => {\r\n  const percentage =\r\n    (props.details.orderConfirmedPercentage +\r\n      props.details.orderCompletedPercentage) /\r\n    2;\r\n\r\n  return productStatus.find((item) => {\r\n    return (\r\n      item.from <= percentage && (item.to >= percentage || item.to == undefined)\r\n    );\r\n  }).color;\r\n});\r\n</script>\r\n\r\n<template>\r\n  <div\r\n    v-if=\"details\"\r\n    class=\"min-w-96 border border-gray-200 shadow-product rounded-md overflow-hidden\"\r\n  >\r\n    <img :src=\"details.featured_image\" class=\"object-cover w-full h-80\" />\r\n\r\n    <div class=\"py-9 px-7 relative\">\r\n      <div\r\n        class=\"w-36 bg-white py-3 flex justify-center text-primary-300 text-2xl rounded-xs absolute gap-2 top-[-25px] left-5\"\r\n      >\r\n        <Icon\r\n          name=\"fluent:bookmark-20-regular\"\r\n          class=\"cursor-pointer\"\r\n          @click=\"saveProduct\"\r\n          v-if=\"!savedProduct && !saveProductIsLoading\"\r\n        />\r\n\r\n        <Icon\r\n          name=\"fluent:bookmark-20-filled\"\r\n          class=\"cursor-pointer\"\r\n          @click=\"removeProduct\"\r\n          v-else-if=\"savedProduct && !saveProductIsLoading\"\r\n        />\r\n        <Icon name=\"icomoon-free:spinner2\" class=\"loading-spinner\" v-else />\r\n        <Icon name=\"ci:line-l\" class=\"text-gray-200\" />\r\n        <Icon\r\n          name=\"la:cart-arrow-down\"\r\n          class=\"cursor-pointer\"\r\n          @click=\"addProductToCart\"\r\n          v-if=\"!addProductToCartIsLoading\"\r\n        />\r\n        <Icon name=\"icomoon-free:spinner2\" class=\"loading-spinner\" v-else />\r\n      </div>\r\n      <span\r\n        class=\"w-[1.5rem] h-[.25rem] rounded-[3rem] block mb-2\"\r\n        :style=\"{ background: productStatuses }\"\r\n      ></span>\r\n      <h1 class=\"text-[28px] leading-10\">{{ details.title }}</h1>\r\n      <div class=\"flex justify-between my-9\">\r\n        <div>\r\n          <h5 class=\"text-gray-400 text-base font-normal mb-1\">\r\n            اقل سعر للبيع\r\n          </h5>\r\n          <h3 class=\"text-2xl\">{{ details.price }}</h3>\r\n        </div>\r\n        <div>\r\n          <h5 class=\"text-gray-400 text-base font-normal mb-1\">\r\n            اقل سعر للربح\r\n          </h5>\r\n          <h3 class=\"text-2xl\">{{ details.minCommission }}</h3>\r\n        </div>\r\n      </div>\r\n      <nuxt-link\r\n        :to=\"`/product/${details.id}`\"\r\n        class=\"text-primary-300 flex gap-1 font-semibold items-center text-lg\"\r\n      >\r\n        <span>تفاصيل المنتج</span>\r\n        <Icon name=\"iconamoon:arrow-left-2-duotone\" class=\"text-2xl\" />\r\n      </nuxt-link>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped></style>\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASA,UAAM,EAAE,uBAAuB,uBAAuB;AAEtD,UAAM,EAAE,YAAY,kBAAkB;AAUtC,UAAM,uBAAuB,IAAI,KAAK;AAEtC,UAAM,eAAe,IAAI,MAAM,QAAQ,WAAW;AAGlD,UAAM,EAAE,MAAM,gBAAiB,IAAG,OAAO;AAAA,MACvC,KAAK,MAAM,oBAAoB,MAAM,MAAM,QAAQ;AAAA,MACnD,gBAAgB;AAAA,QACd,QAAQ;AAAA,MACT;AAAA,IACH,CAAC;AAED,mBAAe,cAAc;AAC3B,2BAAqB,QAAQ;AAC7B,YAAM,EAAE,OAAM,IAAK,MAAM;AACzB,cAAQ,IAAI,MAAM;AAClB,UAAI,OAAO,UAAU,WAAW;AAC9B,qBAAa,QAAQ;AACrB,8BAAsB,mBAAmB,QAAQ,CAAC;AAAA,MACnD;AACD,2BAAqB,QAAQ;AAAA,IAC/B;AAGA,UAAM,EAAE,MAAM,kBAAmB,IAAG,OAAO;AAAA,MACzC,KAAK,MAAM,sBAAsB,MAAM,MAAM,QAAQ;AAAA,MACrD,gBAAgB;AAAA,QACd,QAAQ;AAAA,MACT;AAAA,IACH,CAAC;AAED,mBAAe,gBAAgB;AAC7B,2BAAqB,QAAQ;AAC7B,YAAM,EAAE,OAAM,IAAK,MAAM;AACzB,cAAQ,IAAI,OAAO,KAAK;AACxB,UAAI,OAAO,UAAU,WAAW;AAC9B,qBAAa,QAAQ;AACrB,8BAAsB,mBAAmB,QAAQ,CAAC;AAAA,MACnD;AACD,2BAAqB,QAAQ;AAAA,IAC/B;AAGA,UAAM,4BAA4B,IAAI,KAAK;AAG3C,UAAM,EAAE,MAAM,qBAAsB,IAAG,OAAO;AAAA,MAC5C,KAAK,MAAM;AAAA,MACX,gBAAgB;AAAA,QACd,QAAQ;AAAA,MACT;AAAA,IACH,CAAC;AAED,mBAAe,mBAAmB;AAChC,gCAA0B,QAAQ;AAClC,YAAM,EAAE,WAAW,MAAM,qBAAqB;AAAA,QAC5C,YAAY,MAAM,QAAQ;AAAA,QAC1B,UAAU;AAAA,QACV,aAAa,MAAM,QAAQ;AAAA,MAC/B,CAAG;AACD,UAAI,OAAO,UAAU,WAAW;AAC9B,sBAAc,aAAa,CAAC;AAAA,MAC7B;AACD,gCAA0B,QAAQ;AAAA,IACpC;AAEA,UAAM,kBAAkB,SAAS,MAAM;AACrC,YAAM,cACH,MAAM,QAAQ,2BACb,MAAM,QAAQ,4BAChB;AAEF,aAAO,cAAc,KAAK,CAAC,SAAS;AAClC,eACE,KAAK,QAAQ,eAAe,KAAK,MAAM,cAAc,KAAK,MAAM;AAAA,MAEnE,CAAA,EAAE;AAAA,IACL,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}