{"version":3,"file":"replace-returns-8272a835.js","sources":["../../../../components/dashboard/ReturnOrder.vue","../../../../pages/dashboard/replace-returns.vue"],"sourcesContent":["<script setup>\r\nimport { apiUploadFilesUrl, apiCreateReturnOrderUrl } from \"@/server\";\r\n\r\nconst props = defineProps([\"data\"]);\r\nconst emits = defineEmits([\"hide\", \"refresh\"]);\r\n\r\nconst { selectedCountry } = useCountries();\r\n\r\nconst orderTypes = [\r\n  {\r\n    title: \"استبدال\",\r\n    value: \"refund\",\r\n  },\r\n  {\r\n    title: \"استرجاع\",\r\n    value: \"exchange\",\r\n  },\r\n];\r\n\r\nconst form = reactive({\r\n  reason: \"\",\r\n  return_type: \"refund\",\r\n  image: \"\",\r\n});\r\n\r\nconst selectedType = computed(() =>\r\n  orderTypes.find((item) => item.value === form.return_type),\r\n);\r\n\r\nconst { fire } = useApi({\r\n  url: apiCreateReturnOrderUrl,\r\n  requestOptions: {\r\n    method: \"post\",\r\n    onResponse: (response) => {\r\n      if (response.response.ok) {\r\n        emits(\"refresh\");\r\n        emits(\"hide\");\r\n      }\r\n    },\r\n  },\r\n});\r\n\r\nconst isSubmitting = ref(false);\r\n\r\nasync function createReturnOrder() {\r\n  isSubmitting.value = true;\r\n  await fire({\r\n    ...form,\r\n    order_item_id: props.data.id,\r\n    order_id: props.data.order.id,\r\n    country_id: selectedCountry.value.id,\r\n  });\r\n  isSubmitting.value = false;\r\n}\r\n\r\nconst isUploading = ref(false);\r\n\r\nconst uploadedImage = ref(null);\r\n\r\nasync function uploadImage(e) {\r\n  const files = e.target.files;\r\n  if (files.length) {\r\n    isUploading.value = true;\r\n    const fd = new FormData();\r\n    fd.append(\"image\", files[0]);\r\n    const { fire: uploadFire } = useApi({\r\n      url: apiUploadFilesUrl,\r\n      requestOptions: {\r\n        method: \"post\",\r\n        body: fd,\r\n        onResponse: (response) => {\r\n          if (response.response.ok) {\r\n            form.image = response.response._data.url;\r\n            uploadedImage.value = files[0];\r\n          }\r\n        },\r\n      },\r\n    });\r\n\r\n    await uploadFire(fd);\r\n\r\n    isUploading.value = false;\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"fixed inset-0 z-50\">\r\n    <div class=\"fixed inset-0 bg-black/20\" @click=\"$emit('hide')\"></div>\r\n    <div class=\"w-full h-full px-4 overflow-auto\">\r\n      <div\r\n        class=\"relative z-10 bg-white rounded-lg shadow-main p-8 xl:p-16 w-full max-w-[45rem] my-12 mx-auto\"\r\n        v-if=\"data\"\r\n      >\r\n        <div class=\"relative mb-16\">\r\n          <button\r\n            type=\"button\"\r\n            @click=\"$emit('hide')\"\r\n            class=\"absolute top-0 end-0 text-[1.6rem] text-gray-500\"\r\n          >\r\n            <Icon name=\"clarity:times-line\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form @submit.prevent=\"createReturnOrder\">\r\n          <div class=\"mb-16\">\r\n            <label\r\n              for=\"reason\"\r\n              class=\"block leading-normal text-gray-700 text-2xl mb-4\"\r\n              >تفاصيل الطلب (المشكلة)</label\r\n            >\r\n            <textarea\r\n              id=\"reason\"\r\n              placeholder=\"اكتب هنا ..\"\r\n              v-model=\"form.reason\"\r\n              class=\"h-[7.125rem] w-full block border border-gray-200 rounded-[11px] px-4 py-[.75rem] focus:border-primary-300 focus-within:!outline-0\"\r\n            ></textarea>\r\n          </div>\r\n\r\n          <div class=\"mb-16\">\r\n            <shared-menu\r\n              :items=\"orderTypes\"\r\n              :button-props=\"{\r\n                class: `h-[3.3125rem]  px-8 py-[.38rem]`,\r\n              }\"\r\n              :menu-props=\"{\r\n                class: `max-w-[8rem]`,\r\n              }\"\r\n            >\r\n              <template #label>\r\n                <div class=\"flex items-center gap-[19px]\">\r\n                  <Icon name=\"iconamoon:arrow-down-2-duotone\" />\r\n                  <span v-if=\"form.return_type\">{{ selectedType.title }}</span>\r\n                  <span v-else>نوع الطلب</span>\r\n                </div>\r\n              </template>\r\n              <template #item=\"{ data }\">\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"flex gap-[24px] items-center mb-[19px] last:mb-0 h-[45px]\"\r\n                  @click=\"form.return_type = data.value\"\r\n                >\r\n                  <span>{{ data.title }}</span>\r\n                </button>\r\n              </template>\r\n            </shared-menu>\r\n          </div>\r\n\r\n          <div class=\"mb-16 flex items-center gap-4 flex-wrap\">\r\n            <input\r\n              type=\"file\"\r\n              id=\"upload-avatar\"\r\n              class=\"hidden\"\r\n              @change=\"uploadImage\"\r\n            />\r\n            <label\r\n              class=\"cursor-pointer flex items-center justify-center gap-[1.19rem] leading-normal text-gray-700 text-xl w-fit h-[3.0625rem] border border-gray-200 bg-gray-100 rounded-[.75rem] px-8\"\r\n              for=\"upload-avatar\"\r\n            >\r\n              <div class=\"loading-container\" v-if=\"isUploading\">\r\n                <shared-loders-loader-button />\r\n              </div>\r\n              <img\r\n                v-else\r\n                src=\"@/assets/images/upload-icon.svg\"\r\n                alt=\"upload avatar\"\r\n                class=\"\"\r\n              />\r\n              <span>صورة او فيديو للمنتج</span>\r\n            </label>\r\n\r\n            <div v-if=\"uploadedImage\">{{ uploadedImage.name }}</div>\r\n          </div>\r\n\r\n          <shared-buttons-primary-button\r\n            submit-title=\"ارسال طلب\"\r\n            type=\"submit\"\r\n            :loading=\"isSubmitting\"\r\n          />\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n.loading-container .lds-ellipsis div {\r\n  background-color: theme(\"colors.primary.300\");\r\n}\r\n</style>\r\n","<script setup>\r\nimport { apiGetReturnsItemsUrl } from \"@/server\";\r\n\r\nimport { handleDate } from \"@/helpers\";\r\n\r\nimport { returnedOrderStatus } from \"@/constants\";\r\n\r\nconst { selectedCountry } = useCountries();\r\n\r\nconst title = ref(\"\");\r\n\r\nconst { fire } = useApi({\r\n  url: () => apiGetReturnsItemsUrl,\r\n  requestOptions: {\r\n    query: {\r\n      country_id: selectedCountry.value.id,\r\n      title: title,\r\n    },\r\n    watch: [title],\r\n  },\r\n});\r\n\r\nconst { data, pending, refresh } = await fire();\r\n\r\nconst selectedOrder = ref(null);\r\n\r\nconst isShowReturnModal = ref(false);\r\n\r\nfunction showReturnModal(order) {\r\n  isShowReturnModal.value = true;\r\n  selectedOrder.value = order;\r\n}\r\n\r\nfunction hideReturnModal() {\r\n  isShowReturnModal.value = false;\r\n  selectedOrder.value = null;\r\n}\r\n</script>\r\n\r\n<template>\r\n  <section>\r\n    <h4 class=\"mb-16 text-gray-700 font-normal text-2xl\">\r\n      طلبات السحب السابقة\r\n    </h4>\r\n\r\n    <shared-cards-filter>\r\n      <template #right>\r\n        <div class=\"relative layout-navbar-search\">\r\n          <shared-form-input\r\n            placeholder=\"البحث عن منتج\"\r\n            type=\"text\"\r\n            class=\"pe-[80px] !h-[3.5625rem] !w-[22rem] sm:!w-[35rem]\"\r\n            v-model=\"title\"\r\n          />\r\n          <span\r\n            class=\"absolute top-0 left-0 bottom-0 rounded-tl-[11px] rounded-bl-[11px] bg-primary-100 text-primary-300 w-[75px] flex items-center justify-center border border-gray-200 border-s-0\"\r\n          >\r\n            <icon name=\"system-uicons:search\" class=\"text-4xl\" />\r\n          </span>\r\n        </div>\r\n      </template>\r\n\r\n      <template #left>\r\n        <div class=\"flex items-center gap-4\">\r\n          <!-- <shared-buttons-primary-button\r\n            submit-title=\"الكل\"\r\n            class=\"w-[6.4375rem] !h-[3.5625rem] !min-w-0 !min-h-0 text-xl\"\r\n          />\r\n          <shared-buttons-secondary-button\r\n            submit-title=\"الطلبات السابقة\"\r\n            class=\"w-[12rem] !h-[3.5625rem] !min-w-0 !min-h-0 text-xl\"\r\n          /> -->\r\n        </div>\r\n      </template>\r\n    </shared-cards-filter>\r\n\r\n    <div v-if=\"pending\" class=\"mt-16 flex items-center justify-center\">\r\n      <shared-loders-loading />\r\n    </div>\r\n    <div v-else class=\"mt-16\">\r\n      <div\r\n        v-for=\"order in data.data\"\r\n        :key=\"order.id\"\r\n        class=\"shadow-main p-9 bg-white border border-gray-200 rounded-2xl flex items-center flex-wrap gap-9 mb-9\"\r\n      >\r\n        <img\r\n          :src=\"order.product.featured_image\"\r\n          :alt=\"order.product.title\"\r\n          class=\"w-[7.75rem] h-[7.75rem] rounded-[.5rem]\"\r\n        />\r\n\r\n        <div>\r\n          <h6 class=\"text-2xl text-gray-700 leading-normal mb-[.88rem]\">\r\n            {{ order.product.title }}\r\n            <span\r\n              class=\"px-8 py-[.3rem] text-base returned-order-status rounded-[5.625rem] ms-[1.5rem]\"\r\n              :class=\"order.status_if_returned_before\"\r\n              v-if=\"order.status_if_returned_before\"\r\n              >{{ returnedOrderStatus[order.status_if_returned_before] }}</span\r\n            >\r\n          </h6>\r\n          <div\r\n            class=\"flex flex-wrap items-center gap-4 text-gray-300 text-xl leading-normal\"\r\n          >\r\n            <span>تاريخ الشراء:{{ handleDate(order.order.created_at) }}</span>\r\n            <div class=\"h-[36px] bg-gray-200 w-[1px]\"></div>\r\n            <span>كود الطلب: {{ order.order.order_number }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <button\r\n          class=\"ms-auto flex items-center gap-4 text-primary-300 disabled:text-primary-200 text-lg\"\r\n          :disabled=\"order.is_returned_before\"\r\n          @click=\"showReturnModal(order)\"\r\n        >\r\n          طلب استبدال او استرجاع\r\n          <Icon name=\"material-symbols:chevron-left\" class=\"text-2xl\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </section>\r\n\r\n  <teleport to=\"body\">\r\n    <Transition>\r\n      <dashboard-return-order\r\n        v-if=\"isShowReturnModal\"\r\n        :data=\"selectedOrder\"\r\n        @hide=\"hideReturnModal\"\r\n        @refresh=\"refresh()\"\r\n      />\r\n    </Transition>\r\n  </teleport>\r\n</template>\r\n\r\n<style scoped>\r\n.returned-order-status.pending {\r\n  color: theme(\"colors.status.yellow400\");\r\n  background-color: #fefcf1;\r\n}\r\n\r\n.returned-order-status.confirmed {\r\n  color: theme(\"colors.primary.300\");\r\n  background-color: theme(\"colors.primary.100\");\r\n}\r\n.returned-order-status.rejected {\r\n  color: theme(\"colors.status.error400\");\r\n  background-color: #fdd9d3;\r\n}\r\n</style>\r\n"],"names":["_withAsyncContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM4B,iBAAe;AAE3C,UAAM,aAAa;AAAA,MACjB;AAAA,QACE,OAAO;AAAA,QACP,OAAO;AAAA,MACR;AAAA,MACD;AAAA,QACE,OAAO;AAAA,QACP,OAAO;AAAA,MACR;AAAA,IACH;AAEA,UAAM,OAAO,SAAS;AAAA,MACpB,QAAQ;AAAA,MACR,aAAa;AAAA,MACb,OAAO;AAAA,IACT,CAAC;AAED,UAAM,eAAe;AAAA,MAAS,MAC5B,WAAW,KAAK,CAAC,SAAS,KAAK,UAAU,KAAK,WAAW;AAAA,IAC3D;AAeA,UAAM,eAAe,IAAI,KAAK;AAa9B,UAAM,cAAc,IAAI,KAAK;AAE7B,UAAM,gBAAgB,IAAI,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClD9B,UAAM,EAAE,gBAAe,IAAK;AAE5B,UAAM,QAAQ,IAAI,EAAE;AAEpB,UAAM,EAAE,KAAM,IAAG,OAAO;AAAA,MACtB,KAAK,MAAM;AAAA,MACX,gBAAgB;AAAA,QACd,OAAO;AAAA,UACL,YAAY,gBAAgB,MAAM;AAAA,UAClC;AAAA,QACD;AAAA,QACD,OAAO,CAAC,KAAK;AAAA,MACd;AAAA,IACH,CAAC;AAED,UAAM,EAAE,MAAM,SAAS,QAAS,KAAG,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAM,KAAI,CAAC;AAE9C,UAAM,gBAAgB,IAAI,IAAI;AAE9B,UAAM,oBAAoB,IAAI,KAAK;AAOnC,aAAS,kBAAkB;AACzB,wBAAkB,QAAQ;AAC1B,oBAAc,QAAQ;AAAA,IACxB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}