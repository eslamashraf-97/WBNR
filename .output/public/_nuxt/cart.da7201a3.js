import{_ as E}from"./Title.9bdd06cd.js";import{_ as G}from"./Loading.78e29850.js";import{_ as S}from"./PrimaryButton.3590a7ea.js";import{n as z}from"./entry.6d26f239.js";import{E as i,O as l,F as P,$ as Q,P as t,Q as h,a0 as H,m as _,u,a1 as I,a as v}from"./swiper-vue.cec2437d.js";import{_ as J}from"./LoaderButton.181013ce.js";import{_ as K}from"./Input.ee62193e.js";import{u as M}from"./useCountries.9cb2765d.js";import{u as W}from"./useCartLength.2c8490eb.js";import{u as w}from"./useRequest.c26dc291.js";import{u as q}from"./useApi.a33fd01d.js";import{d as X,e as Y,f as Z,g as tt,h as et}from"./index.91beaf37.js";import"./Icon.fe93bad7.js";import"./state.b5e2d2f6.js";import"./nuxt-link.9b0c7cb7.js";const nt={class:"flex flex-col gap-7 2xl:w-[29.25rem] p-9 bg-white border border-gray-200 rounded-3xl dashboard-aside h-fit shadow-main"},at={class:"text-2xl text-gray-700 font-normal"},st={class:"text-2xl text-gray-500 font-normal"},ot={class:"mt-9"},rt={__name:"Aside",props:["details"],setup(c){const a=[{title:"عدد المنتجات في العربة:",key:"itemsInCart"},{title:"اجمالي سعر البيع:",key:"final_price",coins:"ج.م"},{title:"اجمالي الربح:",key:"price",coins:"ج.م"},{title:"الضريبة:",key:"tax_percentage",coins:"ج.م"},{title:"الربح بعد الضريبة:",key:"tax_amount",coins:"ج.م"}];return(o,m)=>{const f=S;return i(),l("aside",nt,[c.details?(i(),l(P,{key:0},Q(a,(n,p)=>t("div",{class:"flex items-center justify-between",key:p},[t("h5",at,h(n.title),1),t("h5",st,[t("span",null,h(c.details[n.key])+" "+h(n.coins),1)])])),64)):H("",!0),t("div",ot,[_(f,{"submit-title":"اطلب الان",class:"w-[14.5rem] h-[4.1875rem]",onClick:m[0]||(m[0]=n=>("navigateTo"in o?o.navigateTo:u(z))(`/checkout?cart=${c.details.id}`))})])])}}},it=rt,lt=""+new URL("delete-icon.41c3d8bb.svg",import.meta.url).href,ct={class:"table w-full overflow-auto"},dt={class:"w-full"},ut=t("th",{class:"text-2xl text-gray-800 font-normal leading-normal"}," المنتج ",-1),_t=t("th",{class:"text-2xl text-gray-800 font-normal leading-normal"}," السعر ",-1),mt=t("th",{class:"text-2xl text-gray-800 font-normal leading-normal"}," سعر البيع ",-1),pt=t("th",{class:"text-2xl text-gray-800 font-normal leading-normal"}," الكمية ",-1),ft=t("th",{class:"text-2xl text-gray-800 font-normal leading-normal"}," الربح ",-1),ht=["aria-disabled"],xt={key:0},yt={key:1},gt={class:"whitespace-nowrap min-w-fit"},bt={class:"flex items-center gap-[2.25rem]"},Ct=["src","alt"],vt={class:"text-2xl text-gray-700 font-normal leading-normal"},wt={class:"text-2xl text-gray-700 font-normal leading-normal"},kt={class:"relative w-[10.75rem]"},$t=t("div",{class:"absolute top-[1px] left-[1px] bottom-[1px] flex flex-col bg-white rounded-[11px]"},[t("div",{class:"w-[3.5625rem] flex-1 border-s border-s-gray-200 flex items-center justify-center text-xl text-gray-300 font-bold"}," ج.م ")],-1),It={class:"relative w-[6rem]"},qt={class:"absolute top-[1px] left-[1px] bottom-[1px] flex flex-col items-center bg-white rounded-[11px]"},Pt=["onClick"],Qt=["onClick"],Dt={class:"text-2xl text-primary-300 font-normal leading-normal"},Lt=["onClick"],Tt=t("img",{src:lt,alt:"delete",class:""},null,-1),Rt=[Tt],Ot={__name:"Products",props:["products","clearCartIsPending"],emits:["increaseQuantity","decreaseQuantity","deleteCartItem","changePrice","changeQuantity","clearCart"],setup(c){return(a,o)=>{const m=J,f=K;return i(),l("div",ct,[t("table",dt,[t("thead",null,[t("tr",null,[ut,_t,mt,pt,ft,t("th",{class:"text-2xl text-error-400 font-normal leading-normal cursor-pointer whitespace-nowrap",onClick:o[0]||(o[0]=n=>a.$emit("clearCart")),"aria-disabled":c.clearCartIsPending},[c.clearCartIsPending?(i(),l("span",xt,[_(m)])):(i(),l("span",yt," حذف الكل "))],8,ht)])]),t("tbody",null,[(i(!0),l(P,null,Q(c.products,(n,p)=>(i(),l("tr",{key:n.id+p},[t("td",gt,[t("div",bt,[t("img",{src:n.product.featured_image,alt:n.product.title_ar,class:"w-[4.6875rem] h-[4.6875rem] rounded-[0.5rem]"},null,8,Ct),t("h5",vt,h(n.product.title_ar),1)])]),t("td",wt,h(n.product.price),1),t("td",null,[t("div",kt,[_(f,{type:"text",class:"!w-[10.75rem] h-[3.3125rem] bg-transparent text-xl",onInput:r=>a.$emit("changePrice",r.target.value,n),value:n.final_price},null,8,["onInput","value"]),$t])]),t("td",null,[t("div",It,[_(f,{type:"text",class:"w-[6rem] h-[3.3125rem] bg-transparent text-xl",onInput:r=>a.$emit("changeQuantity",r.target.value,n),value:n.quantity},null,8,["onInput","value"]),t("div",qt,[t("button",{type:"button",class:"w-[24px] flex-1 border-b border-b-gray-200 border-s border-s-gray-200",onClick:r=>a.$emit("increaseQuantity",n)}," + ",8,Pt),t("button",{type:"button",class:"w-[24px] flex-1 border-s border-s-gray-200",onClick:r=>a.$emit("decreaseQuantity",n)}," - ",8,Qt)])])]),t("td",Dt,h((n.final_price-n.product.price+n.product.minCommission)*n.quantity),1),t("td",null,[t("button",{type:"button",onClick:r=>a.$emit("deleteCartItem",n.id)},Rt,8,Lt)])]))),128))])])])}}},Ut=Ot,jt={class:"bg-primary"},At={key:0,class:"flex items-center justify-center"},Bt={key:1,class:"flex flex-col 2xl:flex-row justify-start gap-24"},Ft={class:"w-full"},ee={__name:"cart",async setup(c){let a,o;const{selectedCountry:m}=M(),{setCartLength:f,cartLength:n}=W(),{data:p,refresh:r,pending:D}=([a,o]=I(()=>{var e;return w({url:()=>Y,requetOptions:{query:{country_id:(e=m.value)==null?void 0:e.id}}})}),a=await a,o(),a),{data:L,refresh:k}=([a,o]=I(()=>{var e;return w({url:()=>Z,requetOptions:{query:{country_id:(e=m.value)==null?void 0:e.id},onResponse:s=>{var d,g;f((g=(d=s.response)==null?void 0:d._data)==null?void 0:g.data.cart_length)}}})}),a=await a,o(),a),{fire:T}=q({url:et,requestOptions:{method:"post",onResponse:e=>{e.response.ok&&(r(),k())}}}),b=v(!1);async function x(e){b.value=!0,await T(e),b.value=!1}function R(e){const s={product_id:e.product.id,quantity:e.quantity+1,final_price:e.price};x(s)}function O(e){if(e.quantity>1){const s={product_id:e.product.id,quantity:e.quantity-1,final_price:e.price};x(s)}}let y;function U(e,s){clearTimeout(y),y=setTimeout(()=>{if(e>=1){const d={product_id:s.product.id,quantity:e,final_price:s.price};x(d)}},300)}function j(e,s){clearTimeout(y),y=setTimeout(()=>{if(e){const d={product_id:s.product.id,quantity:s.quantity,final_price:e};x(d)}},300)}const $=v(!1);async function A(e){$.value=!0,await w({url:tt+"/"+e,requetOptions:{method:"delete",onResponse:()=>{r()}}}),$.value=!1}const C=v(!1),{fire:B}=q({url:X+"/"+p.value.data.id,requestOptions:{method:"delete",onResponse:e=>{console.log(e),e.response.ok&&(r(),k())}}});async function F(){C.value=!0,await B(),C.value=!1}return(e,s)=>{const d=E,g=G,N=it,V=Ut;return i(),l("section",jt,[_(d,{title:"العربة"}),u(D)||u(b)?(i(),l("div",At,[_(g)])):(i(),l("div",Bt,[_(N,{details:{...u(p).data,itemsInCart:u(L).data.cart_length||u(n)}},null,8,["details"]),t("div",Ft,[_(V,{products:u(p).data.cartItems,onDecreaseQuantity:O,onIncreaseQuantity:R,onDeleteCartItem:A,onChangeQuantity:U,onChangePrice:j,onClearCart:F,clearCartIsPending:u(C)},null,8,["products","clearCartIsPending"])])]))])}}};export{ee as default};
